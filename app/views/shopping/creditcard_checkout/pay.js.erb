Conekta.setPublishableKey('key_FfrkmqPQodQdPFEQ');

Conekta.charge.create({
    amount: <%= @total %>,
    currency: 'MXN',
    description: 'Latest E-Zine',
    card: {
        name: $('#name').val(),
        cvc: $('#verification_value').val(),
        exp_month: $('#month').val(),
        exp_year: $('#year').val(),
        number: $('#number').val(),
        address: {
            street1: 'Alfonso Reyes 231',
            street2: 'Despacho 112',
            street3: 'Condesa',
            city: 'Cuauhtemoc',
            state: 'DF',
            country: 'MX',
            zip: '06100'
        }
    }
}, ConektaSuccessResponseHandler, ConektaFailureResponseHandler);


function ConektaSuccessResponseHandler(response) {
    console.log('sucess',response);
}


function ConektaFailureResponseHandler(response) {
    console.log('failure',response.message);
    <% @message = response.message.to_s %>
    <% puts @message.to_yaml %>
    <%= flash[:notice] =  @message %>
}
